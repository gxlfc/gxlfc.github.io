(window.webpackJsonp=window.webpackJsonp||[]).push([[26],{225:function(t,s,a){"use strict";a.r(s);var n=a(28),e=Object(n.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h2",{attrs:{id:"nginx"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#nginx"}},[t._v("#")]),t._v(" Nginx")]),t._v(" "),a("p",[t._v("高性能http代理和反向代理服务器，内存少 性能优化 5w 并发")]),t._v(" "),a("h3",{attrs:{id:"特性"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#特性"}},[t._v("#")]),t._v(" 特性")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("反向代理")]),t._v(" "),a("ul",[a("li",[t._v("正向代理：客户端需要配置代理服务器，才可以访问；")]),t._v(" "),a("li",[t._v("反向代理：客户端访问服务器，先到反向代理服务器，客户端无感知；")])])]),t._v(" "),a("li",[a("p",[t._v("负载均衡")]),t._v(" "),a("ul",[a("li",[t._v("多个请求并发到服务器，需要增加服务器数量。Nginx通过配置，可以分发到各个服务器中；策略list\n"),a("ul",[a("li",[t._v("轮询策略：每个请求按照时间顺序分配到不同的服务器，如果有服务器宕机，直接从list中删除；")]),t._v(" "),a("li",[t._v("weight：权重越高，分配概率越大")]),t._v(" "),a("li",[t._v("ip_hash：按照ip的hash结果，每个ip固定访问一个服务器地址；")]),t._v(" "),a("li",[t._v("fair：根据请求的响应时间来分配，优先选择响应早的；")])])])])]),t._v(" "),a("li",[a("p",[t._v("动静分离(分配)")]),t._v(" "),a("ul",[a("li",[a("strong",[t._v("动态资源")]),t._v("：服务器用来部署jsp、serverlet等")]),t._v(" "),a("li",[a("strong",[t._v("静态资源")]),t._v("：文件js、css")])])])]),t._v(" "),a("h3",{attrs:{id:"配置文件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#配置文件"}},[t._v("#")]),t._v(" 配置文件")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("全局块")]),t._v(" "),a("ul",[a("li",[t._v("worker_processes")])])]),t._v(" "),a("li",[a("p",[t._v("event")]),t._v(" "),a("ul",[a("li",[t._v("worker_connection 最大连接数")])])]),t._v(" "),a("li",[a("p",[t._v("http模块")]),t._v(" "),a("ul",[a("li",[t._v("upstream")]),t._v(" "),a("li",[t._v("server\n"),a("ul",[a("li",[t._v("proxy_pass")])])])])])]),t._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[t._v("upstream "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    // 负载均衡\n    upstream serverName "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        server http1 "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("weight")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        server http2 "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("weight")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n    server "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        listen "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("9001")]),t._v("\n        // 配置静态资源\n        location /static "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            root /data/static"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        location / "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            proxy_pass http://serverName\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        // backupServer "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\n        location ~ /a "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            proxy_pass http://xxx.xx.xx.xx:8080\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        // backupServer "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v("\n        location ~ /b "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            proxy_pass http://xxx.xx.xx.xx:8081\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("h3",{attrs:{id:"高可用"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#高可用"}},[t._v("#")]),t._v(" 高可用")]),t._v(" "),a("p",[t._v("多个Nginx，主master宕机，其他backup可以替换；")]),t._v(" "),a("ul",[a("li",[t._v("主从模式：每个服务器安装keepalived探活、统一配置虚拟IP地址")])])])}),[],!1,null,null,null);s.default=e.exports}}]);